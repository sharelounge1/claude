==========================================
네이버 지도 기반 체험단 플랫폼
실시간 체험단 매칭 서비스 상세 명세
==========================================

1. 프로젝트 개요
==========================================

1.1. 서비스 개요
- 블로그, 인스타그램, 유튜브 등 SNS 인플루언서가 매장 체험단에 실시간으로 참여할 수 있는 플랫폼
- 조건 충족 시 선정 절차 없이 즉시 신청 및 참여 가능
- 모바일 웹앱으로 개발 후 추후 네이티브 앱 패키징 예정

1.2. 기술 스택
- Frontend: React + TypeScript + Vite
- Backend: Supabase (Database + Authentication)
- Hosting: Render.com
- Map API: Naver Maps API
- Mobile: PWA (추후 React Native / Capacitor로 패키징)
- State Management: Zustand 또는 React Query
- Styling: TailwindCSS + Radix UI

1.3. 사용자 유형
- 인플루언서 (일반 유저): 체험단 신청 및 참여, 후기 작성
- 업주: 매장 등록, 캠페인 생성, QR 스캔, 진행 상황 관리
- 관리자: 전체 시스템 관리 (추후 구현)


2. 인플루언서 기능 명세
==========================================

2.1. 메인 화면 (네이버 지도 기반)
------------------------------------------
[화면 ID: INF-001]
[Route: /]

기능:
- 네이버 지도 API를 사용한 지도 표시
- 현재 체험단 참여 가능한 매장을 지도에 핀포인트로 표시
- 핀 클릭 시 간단한 매장 정보 미리보기 (팝업)
- 핀 선택 시 해당 매장 상세페이지로 이동

상단 UI:
- 검색바: 매장명, 지역명 검색
- 필터 버튼: 필터 선택 모달 오픈

필터 기능:
- SNS 선택: 블로그, 인스타그램, 유튜브 (다중 선택 가능)
- 매장 종류 선택: 카페, 밥집, 고깃집, 술집, 이자카야, 분식, 베이커리, 디저트, 한식당, 중식당, 일식당, 양식당, 패스트푸드, 뷔페, 바/펍 (다중 선택 가능)

필터 적용 시:
- 메인 화면 상단에 선택된 필터 태그로 표시 (예: "블로그", "카페", "고깃집")
- 태그 클릭 시 해당 필터 제거
- "전체 해제" 버튼으로 모든 필터 초기화

지도 상 핀포인트 정보:
- 매장명
- 매장 종류 아이콘
- 현재 모집 중인 인원 수 (예: "3/5명")


2.2. 체험단 리스트 화면
------------------------------------------
[화면 ID: INF-002]
[Route: /campaigns]
[하단 네비게이션: "체험단 리스트"]

표시 형식:
- 리스트 형태 (카드 UI)
- 각 카드에는 매장 대표 이미지, 매장명, 매장 종류, 혜택, 모집 인원, 마감일, 지역 정보 표시

필터 기능:
- 검색어 필터: 매장명, 키워드 검색
- 지역 필터: 서울, 경기, 인천, 부산, 대구, 광주, 대전, 울산, 세종, 강원, 충북, 충남, 전북, 전남, 경북, 경남, 제주 (시/군/구 세부 선택 가능)
- SNS 필터: 블로그, 인스타그램, 유튜브
- 매장 종류 필터: 카페, 밥집, 고깃집, 술집, 이자카야, 분식, 베이커리, 디저트, 한식당, 중식당, 일식당, 양식당, 패스트푸드, 뷔페, 바/펍

카드 UI 구성:
┌─────────────────────────────┐
│ [매장 이미지]               │
│ 매장명                      │
│ 📍 지역 | 🏪 매장 종류       │
│ 💝 혜택: 2인 무료 식사       │
│ 👥 모집: 3/5명              │
│ ⏰ 마감: 2025-12-31         │
│ [신청하기 버튼]             │
└─────────────────────────────┘

정렬 옵션:
- 최신순
- 마감 임박순
- 인기순 (신청자 많은 순)


2.3. 진행 중 체험단 화면
------------------------------------------
[화면 ID: INF-003]
[Route: /my-campaigns]
[하단 네비게이션: "진행중 체험단"]

탭 필터:
- "참여한": QR 스캔 완료한 체험단 (후기 작성 전)
- "완료한": 후기 링크 등록 완료한 체험단

검색어 필터:
- 매장명 검색

7일 이상 미작성 건 표시:
- 상단에 "⚠️ 긴급" 배너와 함께 고정 표시
- 빨간색 테두리로 강조
- "후기 작성 D-N일 남음" 표시 (음수면 "N일 지연")

카드 UI 구성:
┌─────────────────────────────┐
│ ⚠️ 긴급 (7일 이상 미작성)    │ ← 해당 시
│ 매장명                      │
│ 📅 체험일: 2025-01-05       │
│ ⏰ 작성 마감: 2025-01-12    │
│ 📝 상태: 후기 작성 대기     │
│ [후기 작성하기 버튼]        │
└─────────────────────────────┘

제약 사항 안내:
- 7일 이상 지연된 미작성 건이 있는 경우:
  - 팝업 또는 배너로 "미작성 후기를 완료해야 추가 체험단 신청이 가능합니다" 안내
  - 체험단 신청 버튼 비활성화


2.4. 체험단 상세 페이지 (매장 정보)
------------------------------------------
[화면 ID: INF-004]
[Route: /campaigns/:id]

상세 정보:
- 매장 이미지 갤러리 (스와이프)
- 매장명
- 매장 주소
- 매장 전화번호
- 매장 운영 시간
- SNS 종류 (블로그/인스타/유튜브)
- 등급별 모집 인원 및 혜택:
  예) A등급: 2인 무료 식사 (3/5명 모집)
      B등급: 1인 무료 식사 (2/3명 모집)
- 체험단 요구사항 (업주가 작성한 가이드)
- 캠페인 기간
- 마감일

신청 프로세스:
1. "신청하기" 버튼 클릭
2. 본인의 등급 및 SNS 확인 팝업
3. 조건 충족 시 QR 코드 생성
4. QR 코드는 12시간 동안 유효
5. 유효 시간 내 매장 방문하여 업주에게 QR 코드 스캔 요청

QR 코드 생성 조건:
- 본인 등급이 해당 캠페인 모집 등급에 포함되어야 함
- 해당 등급의 모집 인원이 남아있어야 함
- 7일 이상 미작성 후기가 없어야 함

신청 취소:
- QR 코드 생성 후 12시간 이내 상세 페이지에서 "신청 취소" 버튼 클릭 가능
- 취소 시 해당 자리는 다시 모집 인원에 포함됨


2.5. 진행 중 체험단 상세 페이지
------------------------------------------
[화면 ID: INF-005]
[Route: /my-campaigns/:id]

표시 정보:
- 매장 정보 (이름, 주소, 연락처)
- 체험 일시 (QR 스캔 완료 시각)
- 체험단 작성 가이드 (업주가 요청한 내용)
  예) "메뉴 사진 3장 이상 포함", "매장 분위기 언급", "해시태그 #매장명 필수"

후기 링크 등록:
- 입력 필드: URL 입력
- "링크 등록" 버튼 클릭 시 완료 처리
- 완료 후 "완료한" 탭으로 이동

상태 표시:
- "후기 작성 D-N일 남음" (7일 기준)
- 7일 초과 시 "⚠️ N일 지연" 빨간색 표시


2.6. QR 코드 화면
------------------------------------------
[화면 ID: INF-006]
[Route: /qr/:campaignId]

표시 정보:
- QR 코드 (업주가 스캔할 코드)
- 매장명
- 신청 일시
- 유효 시간 카운트다운 (12시간)
  예) "⏰ 남은 시간: 11시간 30분"
- 매장 주소
- 매장 연락처

안내 문구:
- "매장 방문 시 업주에게 이 QR 코드를 보여주세요"
- "12시간 이내 스캔하지 않으면 자동 취소됩니다"

버튼:
- "신청 취소" 버튼


3. 업주 기능 명세
==========================================

3.1. 매장 등록
------------------------------------------
[화면 ID: OWN-001]
[Route: /owner/stores/new]

매장 정보 입력:
- 매장명
- 매장 종류 선택 (카페, 밥집, 고깃집, 술집, 이자카야, 분식, 베이커리, 디저트, 한식당, 중식당, 일식당, 양식당, 패스트푸드, 뷔페, 바/펍)
- 매장 대표 이미지 (최대 5장)
- 매장 전화번호
- 운영 시간

주소 입력 방식:
- Naver 주소 검색 API 사용
- 검색창에 주소 입력 시 자동완성 제안
- 주소 선택 시 자동으로 위도/경도 가져오기
- 지도에 핀포인트 자동 생성 및 표시
- 주소 확인 후 "등록" 버튼 활성화


3.2. 캠페인 생성
------------------------------------------
[화면 ID: OWN-002]
[Route: /owner/campaigns/new]

기본 정보:
- 캠페인명
- 캠페인 기간 설정
  - 시작일
  - 종료일
  - 또는 "N개월 진행" 선택 (1개월, 2개월, 3개월, 6개월, 12개월)
- 매달 진행할 총 인원 수

SNS 선택:
- 블로그
- 인스타그램
- 유튜브
- 다중 선택 가능

등급별 모집 설정 (SNS별로 각각 설정 가능):
- SNS 종류 선택 (블로그 / 인스타그램 / 유튜브)
- 등급 선택 (A, B, C, D)
- 모집 인원
- 제공 혜택 (예: "2인 무료 식사", "30% 할인")
- 요구사항 (예: "사진 3장 이상 필수", "해시태그 필수")

예시:
┌─────────────────────────────────────┐
│ SNS: 블로그                         │
│ - A등급: 5명 | 2인 무료 식사       │
│   요구사항: 사진 5장 이상, 최소 500자│
│ - B등급: 3명 | 1인 무료 식사       │
│   요구사항: 사진 3장 이상           │
├─────────────────────────────────────┤
│ SNS: 인스타그램                     │
│ - A등급: 3명 | 2인 무료 식사       │
│   요구사항: 피드 1개 + 스토리 2개   │
│ - C등급: 5명 | 50% 할인            │
│   요구사항: 피드 1개               │
└─────────────────────────────────────┘


3.3. QR 스캔 기능
------------------------------------------
[화면 ID: OWN-003]
[Route: /owner/qr-scan]

기능:
- "QR 스캔" 버튼 클릭 시 카메라 활성화
- 인플루언서가 제시한 QR 코드 스캔
- QR 코드 유효성 검증:
  - 본인 매장의 캠페인인지 확인
  - 유효 시간 내인지 확인 (12시간)
  - 중복 스캔 방지
- 스캔 성공 시:
  - "체험단 참여 완료" 메시지
  - 인플루언서 정보 표시 (이름, 등급, SNS)
  - 진행 상황 리스트에 "참여 완료자"로 추가
- 스캔 실패 시:
  - 실패 사유 표시 (유효 시간 만료, 타 매장 QR 등)


3.4. 진행 상황 리스트
------------------------------------------
[화면 ID: OWN-004]
[Route: /owner/campaigns/:id/status]

탭 구분:
1. 신청자 (QR 코드 생성자)
   - 아직 매장 방문하지 않은 사용자
   - QR 코드 유효 시간 표시 (카운트다운)

2. 참여 완료자 (QR 스캔 완료)
   - 매장 방문하여 체험 완료
   - 아직 후기 작성하지 않은 사용자
   - 경과일 표시 (예: "체험 후 3일 경과")

3. 미작성자 (7일 경과)
   - 체험 완료 후 7일 이상 후기 작성하지 않은 사용자
   - 상단에 빨간색으로 고정 표시
   - 연락처 표시 (전화 또는 메시지 가능)

4. 작성 완료자
   - 후기 링크까지 등록 완료한 사용자
   - 후기 링크 바로가기 버튼

각 리스트 항목 정보:
- 인플루언서 이름
- 등급 (A/B/C/D)
- SNS 종류 (블로그/인스타/유튜브)
- 신청일 또는 체험일
- 상태 (대기중/참여완료/작성완료)
- 연락처 (미작성자의 경우)

필터 기능:
- 검색어: 인플루언서 이름 검색
- SNS 필터: 블로그, 인스타그램, 유튜브
- 날짜 선택: 특정 기간 내 신청자/참여자 필터링
  - 시작일 ~ 종료일 선택
  - 또는 "최근 7일", "최근 30일", "전체" 빠른 선택

정렬 옵션:
- 신청일순
- 이름순
- 등급순


4. 데이터 모델 (Supabase)
==========================================

4.1. users 테이블
------------------------------------------
- id: UUID (Primary Key)
- email: string
- user_type: enum ('influencer', 'owner', 'admin')
- name: string
- phone: string
- created_at: timestamp
- updated_at: timestamp

4.2. influencer_profiles 테이블
------------------------------------------
- id: UUID (Primary Key)
- user_id: UUID (Foreign Key → users.id)
- blog_url: string (nullable)
- instagram_handle: string (nullable)
- youtube_channel: string (nullable)
- blog_grade: enum ('A', 'B', 'C', 'D') (nullable)
- instagram_grade: enum ('A', 'B', 'C', 'D') (nullable)
- youtube_grade: enum ('A', 'B', 'C', 'D') (nullable)
- blog_followers: integer
- instagram_followers: integer
- youtube_subscribers: integer
- is_blocked: boolean (7일 이상 미작성 건 있을 시 true)
- created_at: timestamp
- updated_at: timestamp

4.3. stores 테이블
------------------------------------------
- id: UUID (Primary Key)
- owner_id: UUID (Foreign Key → users.id)
- name: string
- category: enum ('cafe', 'restaurant', 'meat', 'bar', 'izakaya', 'snack', 'bakery', 'dessert', 'korean', 'chinese', 'japanese', 'western', 'fastfood', 'buffet', 'pub')
- address: string
- latitude: decimal
- longitude: decimal
- phone: string
- business_hours: jsonb
- images: text[] (image URLs)
- created_at: timestamp
- updated_at: timestamp

4.4. campaigns 테이블
------------------------------------------
- id: UUID (Primary Key)
- store_id: UUID (Foreign Key → stores.id)
- title: string
- start_date: date
- end_date: date
- duration_months: integer
- monthly_total_quota: integer
- sns_types: text[] ('blog', 'instagram', 'youtube')
- is_active: boolean
- created_at: timestamp
- updated_at: timestamp

4.5. campaign_requirements 테이블
------------------------------------------
- id: UUID (Primary Key)
- campaign_id: UUID (Foreign Key → campaigns.id)
- sns_type: enum ('blog', 'instagram', 'youtube')
- grade: enum ('A', 'B', 'C', 'D')
- quota: integer (모집 인원)
- benefit: text (제공 혜택)
- requirement: text (요구사항)
- created_at: timestamp

4.6. applications 테이블 (신청 내역)
------------------------------------------
- id: UUID (Primary Key)
- campaign_id: UUID (Foreign Key → campaigns.id)
- influencer_id: UUID (Foreign Key → users.id)
- sns_type: enum ('blog', 'instagram', 'youtube')
- grade: enum ('A', 'B', 'C', 'D')
- qr_code: string (고유 QR 코드 데이터)
- status: enum ('applied', 'visited', 'completed', 'cancelled', 'expired')
- applied_at: timestamp (신청 시각)
- visited_at: timestamp (QR 스캔 시각, nullable)
- review_url: text (후기 링크, nullable)
- completed_at: timestamp (후기 작성 완료 시각, nullable)
- expires_at: timestamp (QR 코드 만료 시각, applied_at + 12시간)
- created_at: timestamp
- updated_at: timestamp


5. 화면 구조 및 네비게이션
==========================================

5.1. 인플루언서 앱 네비게이션 (하단 탭바)
------------------------------------------
1. 홈 (지도) - /
2. 체험단 리스트 - /campaigns
3. 진행중 체험단 - /my-campaigns
4. 마이페이지 - /profile

5.2. 업주 앱 네비게이션 (하단 탭바)
------------------------------------------
1. 내 매장 - /owner/stores
2. 캠페인 관리 - /owner/campaigns
3. QR 스캔 - /owner/qr-scan
4. 마이페이지 - /owner/profile

5.3. 전체 라우트 구조
------------------------------------------
# 공통
- /login - 로그인
- /signup - 회원가입
- /signup/influencer - 인플루언서 가입
- /signup/owner - 업주 가입

# 인플루언서
- / - 메인 (지도)
- /campaigns - 체험단 리스트
- /campaigns/:id - 체험단 상세
- /my-campaigns - 진행중 체험단
- /my-campaigns/:id - 진행중 체험단 상세
- /qr/:campaignId - QR 코드 표시
- /profile - 마이페이지

# 업주
- /owner/stores - 내 매장 목록
- /owner/stores/new - 매장 등록
- /owner/stores/:id/edit - 매장 수정
- /owner/campaigns - 캠페인 목록
- /owner/campaigns/new - 캠페인 생성
- /owner/campaigns/:id - 캠페인 상세
- /owner/campaigns/:id/status - 진행 상황 리스트
- /owner/qr-scan - QR 스캔
- /owner/profile - 마이페이지


6. 핵심 비즈니스 로직
==========================================

6.1. QR 코드 생성 및 관리
------------------------------------------
생성 조건:
1. 인플루언서 등급이 캠페인 요구 등급에 포함됨
2. 해당 등급의 모집 인원이 남아있음
3. 7일 이상 미작성 후기가 없음 (is_blocked = false)

생성 프로세스:
1. applications 테이블에 레코드 생성
2. qr_code 필드에 고유 문자열 저장 (UUID 또는 암호화된 데이터)
3. expires_at = applied_at + 12시간 설정
4. status = 'applied'

만료 처리:
- 백그라운드 작업 (Supabase Functions 또는 Edge Functions)
- 매 1시간마다 expires_at < now() AND status = 'applied' 인 레코드를 'expired'로 변경
- 만료된 레코드는 해당 등급 모집 인원에서 다시 제외 해제

6.2. QR 스캔 검증
------------------------------------------
스캔 시 검증 항목:
1. qr_code가 유효한지 확인 (DB에 존재)
2. status = 'applied' 인지 확인
3. expires_at > now() 인지 확인 (12시간 이내)
4. campaign_id가 업주의 매장 캠페인인지 확인

스캔 성공 시:
1. status = 'visited' 변경
2. visited_at = now() 설정

6.3. 후기 작성 및 완료
------------------------------------------
후기 링크 등록 시:
1. review_url에 URL 저장
2. status = 'completed' 변경
3. completed_at = now() 설정
4. is_blocked = false 유지 (정상 완료)

7일 경과 체크:
- 백그라운드 작업 (매일 1회 실행)
- visited_at + 7일 < now() AND status = 'visited' 인 레코드 조회
- 해당 인플루언서의 is_blocked = true 설정
- 진행중 체험단 화면에서 "긴급" 배너 표시

미작성 건 해소 시:
- 모든 status = 'visited' AND visited_at + 7일 < now() 인 레코드가 'completed'로 변경되면
- is_blocked = false로 재설정

6.4. 체험단 인원 계산
------------------------------------------
모집 인원 체크:
- campaign_requirements 테이블에서 특정 캠페인의 sns_type + grade 조합의 quota 조회
- applications 테이블에서 해당 조합의 status IN ('applied', 'visited', 'completed') 개수 조회
- quota - 신청자 수 = 남은 인원

QR 만료 시 인원 복구:
- status = 'expired' 또는 'cancelled'로 변경되면 해당 자리 다시 오픈


7. 개발 우선순위
==========================================

Phase 1 (MVP):
1. 회원가입 및 로그인 (Supabase Auth)
2. 인플루언서: 메인 지도 화면 (Naver Maps API)
3. 업주: 매장 등록 (Naver 주소 검색 API)
4. 업주: 캠페인 생성 (기본 정보만)
5. 인플루언서: 체험단 리스트 화면
6. 인플루언서: QR 코드 생성
7. 업주: QR 스캔 기능
8. 인플루언서: 진행중 체험단 화면
9. 인플루언서: 후기 링크 등록

Phase 2:
10. 검색 및 필터 기능 (전체)
11. 7일 경과 후기 미작성 체크 및 차단 로직
12. 업주: 진행 상황 리스트
13. QR 코드 만료 처리 (백그라운드 작업)
14. 인플루언서 등급 시스템 (SNS 데이터 분석)

Phase 3:
15. 알림 시스템 (푸시 알림)
16. 리뷰 자동 크롤링 및 검증
17. 통계 및 리포트 기능
18. 관리자 대시보드


8. 주요 API 엔드포인트
==========================================

8.1. 인증
------------------------------------------
POST /auth/signup - 회원가입
POST /auth/login - 로그인
POST /auth/logout - 로그아웃
GET /auth/me - 현재 사용자 정보

8.2. 매장
------------------------------------------
GET /stores - 매장 목록 (지도용, 필터 적용)
GET /stores/:id - 매장 상세
POST /stores - 매장 등록 (업주)
PUT /stores/:id - 매장 수정 (업주)
DELETE /stores/:id - 매장 삭제 (업주)

8.3. 캠페인
------------------------------------------
GET /campaigns - 캠페인 목록 (인플루언서, 필터 적용)
GET /campaigns/:id - 캠페인 상세
POST /campaigns - 캠페인 생성 (업주)
PUT /campaigns/:id - 캠페인 수정 (업주)
DELETE /campaigns/:id - 캠페인 삭제 (업주)

8.4. 신청 및 QR
------------------------------------------
POST /applications - 체험단 신청 (QR 생성)
GET /applications/my - 내 신청 내역 (인플루언서)
GET /applications/:id - 신청 상세
DELETE /applications/:id - 신청 취소 (인플루언서)
POST /applications/:id/scan - QR 스캔 (업주)
PUT /applications/:id/review - 후기 링크 등록 (인플루언서)

8.5. 진행 상황
------------------------------------------
GET /campaigns/:id/applications - 캠페인별 신청자 목록 (업주)
GET /campaigns/:id/statistics - 캠페인 통계 (업주)


9. UI/UX 가이드라인
==========================================

9.1. 색상 팔레트
------------------------------------------
Primary: #4A90E2 (파란색 - 신뢰감)
Secondary: #50E3C2 (민트색 - 신선함)
Accent: #F5A623 (주황색 - 긴급/강조)
Error: #E74C3C (빨간색 - 경고)
Success: #2ECC71 (초록색 - 완료)
Background: #F8F9FA (연한 회색)
Text: #333333 (진한 회색)

9.2. 타이포그래피
------------------------------------------
- 제목: 20px, Bold
- 부제목: 16px, Medium
- 본문: 14px, Regular
- 캡션: 12px, Regular

9.3. 주요 UI 패턴
------------------------------------------
- 카드: 둥근 모서리 (border-radius: 12px), 그림자 (shadow-sm)
- 버튼: Primary (파란색), Secondary (회색), Accent (주황색)
- 입력 필드: 테두리 (border: 1px solid #E0E0E0), 포커스 시 파란색 테두리
- 태그: 작은 둥근 배지 (border-radius: 16px)
- 아이콘: Lucide React 또는 Heroicons 사용


10. 보안 및 고려사항
==========================================

10.1. 보안
------------------------------------------
- Supabase Row Level Security (RLS) 활성화
- 인플루언서는 본인의 신청 내역만 조회 가능
- 업주는 본인 매장의 캠페인만 관리 가능
- QR 코드는 암호화된 토큰 사용 (재생성 불가)

10.2. 성능 최적화
------------------------------------------
- Naver Maps API: 지도 범위 내 매장만 조회 (bounding box 쿼리)
- 리스트 페이지네이션 (무한 스크롤 또는 페이지 네이션)
- 이미지 최적화 (WebP 포맷, lazy loading)

10.3. 모바일 최적화
------------------------------------------
- 반응형 디자인 (Tailwind breakpoints)
- 터치 제스처 지원 (스와이프, 핀치 줌)
- PWA 설정 (manifest.json, service worker)


==========================================
문서 버전: 1.0
최종 수정일: 2025-01-15
==========================================
